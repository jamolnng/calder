---
title: "Exploring Rust through crates.io: Making static websites"
date: 2022-03-26
desc: Building a static website generator in a day with Rocket, Tera, pulldown-cmark, and more
template: _templates/post.html
tags: [rust, rocket, tera]
img: assets/logo.svg
---
Like any *truly grate* developer, I have recently acquired myself with a .dev domain and absolutely nothing to put on it. However, I set out with the goal that I was at least going to make all of that nothing look pretty.

In the past, I have used GitHub Pages in combination with Jekyll templates to generate static webpages that awed tens of people. But I've been learning [Rust](https://www.rust-lang.org/) recently and really love the package management brought by cargo and [crates.io](https://crates.io/). So I wanted to find out what, if any, static site generators were written in Rust and were actually being used.

The top three I found were

* [Zola](https://www.getzola.org/)
* [mdBook](https://github.com/rust-lang/mdBook)
* [Cobalt](https://cobalt-org.github.io/)

and to be honest, Zola really stuck out too, and this post would end right here if I had not chosen the unnecessarily hard route.

On an unreleased project I have been using the [Rocket web framework](https://rocket.rs/) in combination with [Tera template engine](https://tera.netlify.app/). Individually, these crates by themselves are amazing, and using them together makes a very powerful tool. With the knowledge of these two crates and the large pool of available projects on crates.io, I, like any *truly gate* I though the thought we all at one point

> What if I wrote it myself?

And so that is what I did and that is what you are reading this on. This site was generated by a static site generator that built in less a day[^1]. Here's a link to the [source.](https://github.com/jamolnng/calder)

I'm going to use the rest of your time to highlight the crates that contribute to the core functionality of this project:

1) [Tera](https://tera.netlify.app/) and [pulldown-cmark](https://github.com/raphlinus/pulldown-cmark) for templating and markdown support
2) [minifier](https://github.com/GuillaumeGomez/minifier-rs) and [html-minifier](https://github.com/magiclen/html-minifier) for minifying the output
3) [Rocket]((https://rocket.rs/)) for viewing results/self-hosting

While not necessary, Rocket gives the opportunity to self-host for either production or testing before pushing to something like GitHub or Gitlab pages since they take a few minutes to propagate. actix-web could have been substituted but I found Rocket fairly easy to use with a good amount of documentation.

### Tera
is the backbone of this project in my opinion. Super simple to use, great documentation. One of my favorite features built into this project is the ability to have markdown, using pulldown-cmark, inline with HTML using a Tera filter function:

```rust
fn tera_markdown(
  value: &Value, _: &HashMap<String, Value>,
) -> tera::Result<Value> {
  let data = tera::try_get_value!("markdown", "value", String, value);

  let options = Options::all();
  let parser = Parser::new_ext(&data, options);
  let mut html = String::with_capacity(data.len());
  html::push_html(&mut html, parser);
  Ok(to_value(html).unwrap())
}

tera.register_filter("markdown", tera_markdown);
```

```html
<div>Some HTML thing</div>
{% filter markdown %}
# Hello, World!
{% endfilter %}
<div>Some more HTML thing</div>
```

yields

```html
<div>Some HTML thing</div>
<h1>Hello, World!</h1>
<div>Some more HTML thing</div>
```

### pulldown-cmark

...

### minifier/html-minifier

...

### Rocket

...

# // still a work in progress

---
<span style="font-size:10pt">
1) <a name="1"></a>Version 0.1.1 was built in 9hrs, but a few small things have been added in 4 commits since. Notably: html inline markdown
</span>